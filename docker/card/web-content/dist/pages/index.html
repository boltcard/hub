<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bolt Card Hub - Phoenix Edition</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script type="module">
        function e(t) {
            var r = document.getElementById("log-msgs");
            r.appendChild(document.createTextNode(t)), r.appendChild(document.createElement("br"))
        }
        e("start");
        document.addEventListener("DOMContentLoaded", async () => {
            try {
                var t = "NDEFReader" in window;
                if (!t) e("NFCNotSupported");
                else {
                    e("WaitingForPermission");
                    var r = (await navigator.permissions.query({
                        name: "nfc"
                    })).state === "granted";
                    r && (e("WaitingForCard"), o())
                }
            } catch (n) {
                e(n)
            }
        });
        async function o() {
            e("Starting scan");
            try {
                const t = new NDEFReader;
                await t.scan(), e("Scan started"), t.addEventListener("readingerror", () => {
                    e("Cannot read data from the NFC tag.")
                }), t.addEventListener("reading", ({
                    message: r,
                    serialNumber: n
                }) => {
                    e("*** card read ***"), e(`Serial Number: ${n}`), e(`Records: (${r.records.length})`);
                    const c = new TextDecoder,
                        d = r.records[0];
                    if (r.records.length === 0) {
                        e("Card is blank");
                        return
                    }
                    const a = new TextDecoder("utf-8").decode(d.data);
                    e("decoded: " + a)
                })
            } catch (t) {
                e("error: " + t)
            }
        }
    </script>
</head>

<body>
    <ul class="list-group">
        <li class="list-group-item"><a href="/admin/">admin page</a></li>
        <li class="list-group-item"><a href="/bolt12/">bolt12 test page</a></li>
    </ul>
    <h3>Web NFC test</h3>
    <div id="log-msgs"></div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>

</html>